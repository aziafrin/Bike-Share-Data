{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/azizaafrin/cyclistic-bike-share-data?scriptVersionId=98127613\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown","outputs":[],"execution_count":0},{"cell_type":"markdown","id":"09eeb6cb","metadata":{"papermill":{"duration":0.011043,"end_time":"2022-06-12T04:45:56.299144","exception":false,"start_time":"2022-06-12T04:45:56.288101","status":"completed"},"tags":[]},"source":["# Loading Data"]},{"cell_type":"markdown","id":"0d9209a6","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","papermill":{"duration":0.009705,"end_time":"2022-06-12T04:45:56.318561","exception":false,"start_time":"2022-06-12T04:45:56.308856","status":"completed"},"tags":[]},"source":["dt2106<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202106-divvy-tripdata.csv\")\n","dt2107<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202107-divvy-tripdata.csv\")\n","dt2108<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202108-divvy-tripdata.csv\")\n","dt2109<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202109-divvy-tripdata.csv\")\n","dt2110<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202110-divvy-tripdata.csv\")\n","dt2111<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202111-divvy-tripdata.csv\")\n","dt2112<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202112-divvy-tripdata.csv\")\n","dt2201<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202201-divvy-tripdata.csv\")\n","dt2202<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202202-divvy-tripdata.csv\")\n","dt2203<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202203-divvy-tripdata.csv\")\n","dt2204<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202204-divvy-tripdata.csv\")\n","dt2205<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202205-divvy-tripdata.csv\")"]},{"cell_type":"markdown","id":"cae0ce0d","metadata":{"papermill":{"duration":0.009821,"end_time":"2022-06-12T04:45:56.338217","exception":false,"start_time":"2022-06-12T04:45:56.328396","status":"completed"},"tags":[]},"source":["# Loading the required packages"]},{"cell_type":"markdown","id":"838fb1a5","metadata":{"papermill":{"duration":0.010179,"end_time":"2022-06-12T04:45:56.357959","exception":false,"start_time":"2022-06-12T04:45:56.34778","status":"completed"},"tags":[]},"source":["library(tidyverse)\n","library(tidyr)\n","library(dplyr)\n","library(lubridate)\n","library(ggplot2)"]},{"cell_type":"markdown","id":"6ce34c34","metadata":{"papermill":{"duration":0.009816,"end_time":"2022-06-12T04:45:56.37747","exception":false,"start_time":"2022-06-12T04:45:56.367654","status":"completed"},"tags":[]},"source":["colnames(dt2107)\n","head(dt2106)"]},{"cell_type":"markdown","id":"b56bcedb","metadata":{"papermill":{"duration":0.010164,"end_time":"2022-06-12T04:45:56.397318","exception":false,"start_time":"2022-06-12T04:45:56.387154","status":"completed"},"tags":[]},"source":["# Renaming the variable names"]},{"cell_type":"markdown","id":"ad8fd34f","metadata":{"papermill":{"duration":0.010718,"end_time":"2022-06-12T04:45:56.417617","exception":false,"start_time":"2022-06-12T04:45:56.406899","status":"completed"},"tags":[]},"source":["dt2106<- rename(dt2106,  trip_id= ride_id,\n","                bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"efb8c269","metadata":{"papermill":{"duration":0.010008,"end_time":"2022-06-12T04:45:56.437573","exception":false,"start_time":"2022-06-12T04:45:56.427565","status":"completed"},"tags":[]},"source":["dt2107<- rename(dt2107,  trip_id= ride_id,\n","                bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"8bb16222","metadata":{"papermill":{"duration":0.01019,"end_time":"2022-06-12T04:45:56.457673","exception":false,"start_time":"2022-06-12T04:45:56.447483","status":"completed"},"tags":[]},"source":["dt2108<- rename(dt2108,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"ff6ede9d","metadata":{"papermill":{"duration":0.010095,"end_time":"2022-06-12T04:45:56.477654","exception":false,"start_time":"2022-06-12T04:45:56.467559","status":"completed"},"tags":[]},"source":["dt2109<- rename(dt2109,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"dbe4a5af","metadata":{"papermill":{"duration":0.010252,"end_time":"2022-06-12T04:45:56.497836","exception":false,"start_time":"2022-06-12T04:45:56.487584","status":"completed"},"tags":[]},"source":["dt2110<- rename(dt2110,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"d47a3feb","metadata":{"papermill":{"duration":0.010011,"end_time":"2022-06-12T04:45:56.517574","exception":false,"start_time":"2022-06-12T04:45:56.507563","status":"completed"},"tags":[]},"source":["dt2111<- rename(dt2111,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"d3d36a00","metadata":{"papermill":{"duration":0.010041,"end_time":"2022-06-12T04:45:56.537336","exception":false,"start_time":"2022-06-12T04:45:56.527295","status":"completed"},"tags":[]},"source":["dt2112<- rename(dt2112,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"76c38a98","metadata":{"papermill":{"duration":0.010802,"end_time":"2022-06-12T04:45:56.557816","exception":false,"start_time":"2022-06-12T04:45:56.547014","status":"completed"},"tags":[]},"source":["dt2201<- rename(dt2201,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"87f0b275","metadata":{"papermill":{"duration":0.018874,"end_time":"2022-06-12T04:45:56.586415","exception":false,"start_time":"2022-06-12T04:45:56.567541","status":"completed"},"tags":[]},"source":["dt2202<- rename(dt2202,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )"]},{"cell_type":"markdown","id":"e7c94d77","metadata":{"papermill":{"duration":0.01006,"end_time":"2022-06-12T04:45:56.606568","exception":false,"start_time":"2022-06-12T04:45:56.596508","status":"completed"},"tags":[]},"source":["dt2203<- rename(dt2203,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )"]},{"cell_type":"markdown","id":"ea527c69","metadata":{"papermill":{"duration":0.009815,"end_time":"2022-06-12T04:45:56.626322","exception":false,"start_time":"2022-06-12T04:45:56.616507","status":"completed"},"tags":[]},"source":["dt2204<- rename(dt2204,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )"]},{"cell_type":"markdown","id":"54825a1a","metadata":{"papermill":{"duration":0.009803,"end_time":"2022-06-12T04:45:56.645704","exception":false,"start_time":"2022-06-12T04:45:56.635901","status":"completed"},"tags":[]},"source":["dt2205<- rename(dt2205,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )"]},{"cell_type":"markdown","id":"22aaa272","metadata":{"papermill":{"duration":0.010722,"end_time":"2022-06-12T04:45:56.666159","exception":false,"start_time":"2022-06-12T04:45:56.655437","status":"completed"},"tags":[]},"source":["# Checking all the variable names are same"]},{"cell_type":"markdown","id":"3ea484f1","metadata":{"papermill":{"duration":0.009685,"end_time":"2022-06-12T04:45:56.685665","exception":false,"start_time":"2022-06-12T04:45:56.67598","status":"completed"},"tags":[]},"source":["colnames(dt2106)\n","colnames(dt2107)\n","colnames(dt2108)\n","colnames(dt2109)\n","colnames(dt2110)\n","colnames(dt2111)\n","colnames(dt2112)\n","colnames(dt2201)\n","colnames(dt2202)\n","colnames(dt2203)\n","colnames(dt2204)\n","colnames(dt2205)\n"]},{"cell_type":"markdown","id":"899e782e","metadata":{"papermill":{"duration":0.009851,"end_time":"2022-06-12T04:45:56.705195","exception":false,"start_time":"2022-06-12T04:45:56.695344","status":"completed"},"tags":[]},"source":["# Combining previous 12 months data"]},{"cell_type":"markdown","id":"3d8468a5","metadata":{"papermill":{"duration":0.010037,"end_time":"2022-06-12T04:45:56.724928","exception":false,"start_time":"2022-06-12T04:45:56.714891","status":"completed"},"tags":[]},"source":["all_ride<-  rbind(dt2106,dt2107,dt2108,dt2109,dt2110,dt2111,dt2112,dt2201,dt2202,dt2203,dt2204,dt2205)\n","head(all_ride)"]},{"cell_type":"markdown","id":"79750435","metadata":{"papermill":{"duration":0.009976,"end_time":"2022-06-12T04:45:56.744727","exception":false,"start_time":"2022-06-12T04:45:56.734751","status":"completed"},"tags":[]},"source":["head(all_ride)"]},{"cell_type":"markdown","id":"237b9e0a","metadata":{"papermill":{"duration":0.009997,"end_time":"2022-06-12T04:45:56.764611","exception":false,"start_time":"2022-06-12T04:45:56.754614","status":"completed"},"tags":[]},"source":["# Excluding unnecessary variables"]},{"cell_type":"markdown","id":"65202487","metadata":{"papermill":{"duration":0.010093,"end_time":"2022-06-12T04:45:56.784376","exception":false,"start_time":"2022-06-12T04:45:56.774283","status":"completed"},"tags":[]},"source":["all_ride <- all_ride %>%  \n","  select(-c(start_lat,start_lng,end_lng,end_lat))\n"]},{"cell_type":"markdown","id":"443b543c","metadata":{"papermill":{"duration":0.010073,"end_time":"2022-06-12T04:45:56.804256","exception":false,"start_time":"2022-06-12T04:45:56.794183","status":"completed"},"tags":[]},"source":["# Getting a overview of the data\n","nrow(all_ride)\n","head(all_ride)\n","str(all_ride)\n","colnames(all_ride)\n","dim(all_ride)\n","summary(all_ride)\n","glimpse(all_ride)\n"]},{"cell_type":"markdown","id":"30b2d960","metadata":{"papermill":{"duration":0.010318,"end_time":"2022-06-12T04:45:56.824439","exception":false,"start_time":"2022-06-12T04:45:56.814121","status":"completed"},"tags":[]},"source":["table(all_ride$usertype)\n"]},{"cell_type":"markdown","id":"e0bf2876","metadata":{"papermill":{"duration":0.010054,"end_time":"2022-06-12T04:45:56.844416","exception":false,"start_time":"2022-06-12T04:45:56.834362","status":"completed"},"tags":[]},"source":["# Recoding Date variable as Date formate\n"," all_ride <-  all_ride %>% \n","  mutate(date = as.Date(start_time))"]},{"cell_type":"markdown","id":"130301ff","metadata":{"papermill":{"duration":0.010111,"end_time":"2022-06-12T04:45:56.86449","exception":false,"start_time":"2022-06-12T04:45:56.854379","status":"completed"},"tags":[]},"source":["all_ride$month <- format(as.Date(all_ride$date), \"%m\")\n","all_ride$day <- format(as.Date(all_ride$date), \"%d\")\n","all_ride$year <- format(as.Date(all_ride$date), \"%Y\")\n","all_ride$day_of_week <- format(as.Date(all_ride$date), \"%A\")\n"]},{"cell_type":"markdown","id":"3f9a6a87","metadata":{"papermill":{"duration":0.010299,"end_time":"2022-06-12T04:45:56.885047","exception":false,"start_time":"2022-06-12T04:45:56.874748","status":"completed"},"tags":[]},"source":["all_ride$ride_length <- difftime(all_ride$end_time,all_ride$start_time)"]},{"cell_type":"markdown","id":"21c7a50a","metadata":{"papermill":{"duration":0.010733,"end_time":"2022-06-12T04:45:56.905529","exception":false,"start_time":"2022-06-12T04:45:56.894796","status":"completed"},"tags":[]},"source":["head(all_ride)\n","str(all_ride)"]},{"cell_type":"markdown","id":"60ccfc59","metadata":{"papermill":{"duration":0.009758,"end_time":"2022-06-12T04:45:56.925162","exception":false,"start_time":"2022-06-12T04:45:56.915404","status":"completed"},"tags":[]},"source":["class(all_ride$ride_length)\n","\n","all_ride$ride_length <- as.numeric(as.character(all_ride$ride_length))\n","is.numeric(all_ride$ride_length)\n"]},{"cell_type":"markdown","id":"bd3d640a","metadata":{"papermill":{"duration":0.010217,"end_time":"2022-06-12T04:45:56.945151","exception":false,"start_time":"2022-06-12T04:45:56.934934","status":"completed"},"tags":[]},"source":["head(all_ride)\n","glimpse(all_ride)"]},{"cell_type":"markdown","id":"6db76289","metadata":{"papermill":{"duration":0.009821,"end_time":"2022-06-12T04:45:56.964662","exception":false,"start_time":"2022-06-12T04:45:56.954841","status":"completed"},"tags":[]},"source":["# removing bad data\n","\n","all_ride_v2 <- all_ride[!(all_ride$from_station_name== \"HQ QR\" | all_ride$ride_length<0),]\n"]},{"cell_type":"markdown","id":"45888615","metadata":{"papermill":{"duration":0.009851,"end_time":"2022-06-12T04:45:56.984176","exception":false,"start_time":"2022-06-12T04:45:56.974325","status":"completed"},"tags":[]},"source":["colnames(all_ride_v2)"]},{"cell_type":"markdown","id":"4b88c76b","metadata":{"papermill":{"duration":0.009866,"end_time":"2022-06-12T04:45:57.003636","exception":false,"start_time":"2022-06-12T04:45:56.99377","status":"completed"},"tags":[]},"source":["write.csv(all_ride_v2,\"all_ride_v2.csv\")"]},{"cell_type":"markdown","id":"e3dcdeaa","metadata":{"papermill":{"duration":0.009896,"end_time":"2022-06-12T04:45:57.023189","exception":false,"start_time":"2022-06-12T04:45:57.013293","status":"completed"},"tags":[]},"source":["all_ride_v3<- subset(all_ride,all_ride$from_station_name != \"HQ QR\" & ride_length >=0)"]},{"cell_type":"markdown","id":"b48dada1","metadata":{"papermill":{"duration":0.00987,"end_time":"2022-06-12T04:45:57.042654","exception":false,"start_time":"2022-06-12T04:45:57.032784","status":"completed"},"tags":[]},"source":["nrow(all_ride_v2)\n","nrow(all_ride_v3)"]},{"cell_type":"markdown","id":"b03ba581","metadata":{"papermill":{"duration":0.009897,"end_time":"2022-06-12T04:45:57.062262","exception":false,"start_time":"2022-06-12T04:45:57.052365","status":"completed"},"tags":[]},"source":["#descriptive analysis\n"]},{"cell_type":"markdown","id":"e566f3c3","metadata":{"papermill":{"duration":0.009684,"end_time":"2022-06-12T04:45:57.081631","exception":false,"start_time":"2022-06-12T04:45:57.071947","status":"completed"},"tags":[]},"source":["summary(all_ride_v2$ride_length)"]},{"cell_type":"markdown","id":"a4771856","metadata":{"papermill":{"duration":0.009877,"end_time":"2022-06-12T04:45:57.101147","exception":false,"start_time":"2022-06-12T04:45:57.09127","status":"completed"},"tags":[]},"source":["\n","# Compare members and casual users\n","aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype, FUN = mean)\n","aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype, FUN = median)\n","aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype, FUN = max)\n","aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype, FUN = min)\n"]},{"cell_type":"markdown","id":"89992d27","metadata":{"papermill":{"duration":0.00984,"end_time":"2022-06-12T04:45:57.120602","exception":false,"start_time":"2022-06-12T04:45:57.110762","status":"completed"},"tags":[]},"source":["aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype + all_ride_v2$day_of_week, FUN = mean)"]},{"cell_type":"markdown","id":"2be132cf","metadata":{"papermill":{"duration":0.010286,"end_time":"2022-06-12T04:45:57.140545","exception":false,"start_time":"2022-06-12T04:45:57.130259","status":"completed"},"tags":[]},"source":["all_ride_v2$day_of_week <- ordered(all_ride_v2$day_of_week, levels=c(\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"))\n"]},{"cell_type":"markdown","id":"6e799833","metadata":{"papermill":{"duration":0.009901,"end_time":"2022-06-12T04:45:57.160077","exception":false,"start_time":"2022-06-12T04:45:57.150176","status":"completed"},"tags":[]},"source":["colnames(all_ride_v2)"]},{"cell_type":"markdown","id":"78dca96e","metadata":{"papermill":{"duration":0.00989,"end_time":"2022-06-12T04:45:57.17961","exception":false,"start_time":"2022-06-12T04:45:57.16972","status":"completed"},"tags":[]},"source":["# Creating a csv file by reducing column to visualize at tableau"]},{"cell_type":"markdown","id":"f8246d8d","metadata":{"papermill":{"duration":0.009969,"end_time":"2022-06-12T04:45:57.199147","exception":false,"start_time":"2022-06-12T04:45:57.189178","status":"completed"},"tags":[]},"source":["all_ride_v4 <- all_ride_v2 %>%  \n","  select(-c(trip_id,bikeid,from_station_id,to_station_id,date,end_lat))\n"]},{"cell_type":"markdown","id":"d714043b","metadata":{"papermill":{"duration":0.010379,"end_time":"2022-06-12T04:45:57.219103","exception":false,"start_time":"2022-06-12T04:45:57.208724","status":"completed"},"tags":[]},"source":["colnames(all_ride_v4)\n"]},{"cell_type":"markdown","id":"f732d1c6","metadata":{"papermill":{"duration":0.009874,"end_time":"2022-06-12T04:45:57.238675","exception":false,"start_time":"2022-06-12T04:45:57.228801","status":"completed"},"tags":[]},"source":["write.csv(all_ride_v4, \"all_ride_v4.csv\")"]},{"cell_type":"markdown","id":"c7cb29b2","metadata":{"papermill":{"duration":0.009849,"end_time":"2022-06-12T04:45:57.258162","exception":false,"start_time":"2022-06-12T04:45:57.248313","status":"completed"},"tags":[]},"source":["head(all_ride_v4)"]},{"cell_type":"markdown","id":"362f2e43","metadata":{"papermill":{"duration":0.009935,"end_time":"2022-06-12T04:45:57.277641","exception":false,"start_time":"2022-06-12T04:45:57.267706","status":"completed"},"tags":[]},"source":["# Continueing exploratory analysis in R"]},{"cell_type":"markdown","id":"126ddf44","metadata":{"papermill":{"duration":0.00992,"end_time":"2022-06-12T04:45:57.29724","exception":false,"start_time":"2022-06-12T04:45:57.28732","status":"completed"},"tags":[]},"source":["aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype + all_ride_v2$day_of_week, FUN = mean)"]},{"cell_type":"markdown","id":"363d0892","metadata":{"papermill":{"duration":0.009846,"end_time":"2022-06-12T04:45:57.316651","exception":false,"start_time":"2022-06-12T04:45:57.306805","status":"completed"},"tags":[]},"source":["# Analyze ridership data by type and weekday\n","all_ride_v2 %>% \n","  mutate(weekday = wday(start_time, label = TRUE)) %>%  \n","group_by(usertype, weekday) %>%  \n","  summarise(number_of_rides = n()\n","  ,average_duration = mean(ride_length)) %>% \n","  arrange(usertype, weekday)"]},{"cell_type":"markdown","id":"ae694e5f","metadata":{"papermill":{"duration":0.0098,"end_time":"2022-06-12T04:45:57.336068","exception":false,"start_time":"2022-06-12T04:45:57.326268","status":"completed"},"tags":[]},"source":["# Let's visualize the number of rides by rider type\n","all_ride_v2 %>% \n","  mutate(weekday = wday(start_time, label = TRUE)) %>% \n","  group_by(usertype, weekday) %>% \n","  summarise(number_of_rides = n()\n","            ,average_duration = mean(ride_length)) %>% \n","  arrange(usertype, weekday)  %>% \n","  ggplot(aes(x = weekday, y = number_of_rides, fill = usertype)) +\n","  geom_col(position = \"dodge\")\n"]},{"cell_type":"markdown","id":"7d18492d","metadata":{"papermill":{"duration":0.009828,"end_time":"2022-06-12T04:45:57.35553","exception":false,"start_time":"2022-06-12T04:45:57.345702","status":"completed"},"tags":[]},"source":["# Let's create a visualization for average duration\n","all_ride_v2 %>% \n","  mutate(weekday = wday(start_time, label = TRUE)) %>% \n","  group_by(usertype, weekday) %>% \n","  summarise(number_of_rides = n()\n","            ,average_duration = mean(ride_length)) %>% \n","  arrange(usertype, weekday)  %>% \n","  ggplot(aes(x = weekday, y = average_duration, fill = usertype)) +\n","  geom_col(position = \"dodge\")\n","\n"]},{"cell_type":"markdown","id":"513a6a71","metadata":{"papermill":{"duration":0.0105,"end_time":"2022-06-12T04:45:57.375776","exception":false,"start_time":"2022-06-12T04:45:57.365276","status":"completed"},"tags":[]},"source":["avg_ride_length <- aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype + all_ride_v2$day_of_week, FUN = mean)"]},{"cell_type":"markdown","id":"9e4bef03","metadata":{"papermill":{"duration":0.009727,"end_time":"2022-06-12T04:45:57.395178","exception":false,"start_time":"2022-06-12T04:45:57.385451","status":"completed"},"tags":[]},"source":["write.csv(avg_ride_length,\"avg_ride_length.csv\")\n"]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":5.035318,"end_time":"2022-06-12T04:45:57.527098","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2022-06-12T04:45:52.49178","version":"2.3.4"}},"nbformat":4,"nbformat_minor":5}