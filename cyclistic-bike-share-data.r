{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/azizaafrin/cyclistic-bike-share-data-analysis?scriptVersionId=98835937\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown","outputs":[],"execution_count":0},{"cell_type":"markdown","id":"0a815161","metadata":{"papermill":{"duration":0.011518,"end_time":"2022-06-20T08:15:04.319468","exception":false,"start_time":"2022-06-20T08:15:04.30795","status":"completed"},"tags":[]},"source":["# Loading Data"]},{"cell_type":"markdown","id":"eb2f4e09","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","papermill":{"duration":0.010043,"end_time":"2022-06-20T08:15:04.340313","exception":false,"start_time":"2022-06-20T08:15:04.33027","status":"completed"},"tags":[]},"source":["dt2106<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202106-divvy-tripdata.csv\")\n","dt2107<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202107-divvy-tripdata.csv\")\n","dt2108<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202108-divvy-tripdata.csv\")\n","dt2109<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202109-divvy-tripdata.csv\")\n","dt2110<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202110-divvy-tripdata.csv\")\n","dt2111<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202111-divvy-tripdata.csv\")\n","dt2112<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202112-divvy-tripdata.csv\")\n","dt2201<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202201-divvy-tripdata.csv\")\n","dt2202<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202202-divvy-tripdata.csv\")\n","dt2203<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202203-divvy-tripdata.csv\")\n","dt2204<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202204-divvy-tripdata.csv\")\n","dt2205<- read.csv(\"../input/cyclist-trip-data-june-21-to-june-22/202205-divvy-tripdata.csv\")"]},{"cell_type":"markdown","id":"406dcfab","metadata":{"papermill":{"duration":0.009878,"end_time":"2022-06-20T08:15:04.359973","exception":false,"start_time":"2022-06-20T08:15:04.350095","status":"completed"},"tags":[]},"source":["# Loading the required packages"]},{"cell_type":"markdown","id":"ebcec33f","metadata":{"papermill":{"duration":0.0099,"end_time":"2022-06-20T08:15:04.379556","exception":false,"start_time":"2022-06-20T08:15:04.369656","status":"completed"},"tags":[]},"source":["library(tidyverse)\n","library(tidyr)\n","library(dplyr)\n","library(lubridate)\n","library(ggplot2)"]},{"cell_type":"markdown","id":"2228938b","metadata":{"papermill":{"duration":0.009943,"end_time":"2022-06-20T08:15:04.399212","exception":false,"start_time":"2022-06-20T08:15:04.389269","status":"completed"},"tags":[]},"source":["colnames(dt2107)\n","head(dt2106)"]},{"cell_type":"markdown","id":"4c540040","metadata":{"papermill":{"duration":0.009902,"end_time":"2022-06-20T08:15:04.418874","exception":false,"start_time":"2022-06-20T08:15:04.408972","status":"completed"},"tags":[]},"source":["# Renaming the variable names"]},{"cell_type":"markdown","id":"5deb6241","metadata":{"papermill":{"duration":0.010752,"end_time":"2022-06-20T08:15:04.439347","exception":false,"start_time":"2022-06-20T08:15:04.428595","status":"completed"},"tags":[]},"source":["dt2106<- rename(dt2106,  trip_id= ride_id,\n","                bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"971aec16","metadata":{"papermill":{"duration":0.010012,"end_time":"2022-06-20T08:15:04.459677","exception":false,"start_time":"2022-06-20T08:15:04.449665","status":"completed"},"tags":[]},"source":["dt2107<- rename(dt2107,  trip_id= ride_id,\n","                bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"c29097c8","metadata":{"papermill":{"duration":0.009965,"end_time":"2022-06-20T08:15:04.479316","exception":false,"start_time":"2022-06-20T08:15:04.469351","status":"completed"},"tags":[]},"source":["dt2108<- rename(dt2108,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"43ab3a30","metadata":{"papermill":{"duration":0.009916,"end_time":"2022-06-20T08:15:04.499011","exception":false,"start_time":"2022-06-20T08:15:04.489095","status":"completed"},"tags":[]},"source":["dt2109<- rename(dt2109,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"da11bc76","metadata":{"papermill":{"duration":0.009991,"end_time":"2022-06-20T08:15:04.518688","exception":false,"start_time":"2022-06-20T08:15:04.508697","status":"completed"},"tags":[]},"source":["dt2110<- rename(dt2110,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"ad7ef36b","metadata":{"papermill":{"duration":0.010719,"end_time":"2022-06-20T08:15:04.539198","exception":false,"start_time":"2022-06-20T08:15:04.528479","status":"completed"},"tags":[]},"source":["dt2111<- rename(dt2111,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"3e596052","metadata":{"papermill":{"duration":0.010471,"end_time":"2022-06-20T08:15:04.56062","exception":false,"start_time":"2022-06-20T08:15:04.550149","status":"completed"},"tags":[]},"source":["dt2112<- rename(dt2112,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"8b89eb81","metadata":{"papermill":{"duration":0.010035,"end_time":"2022-06-20T08:15:04.580495","exception":false,"start_time":"2022-06-20T08:15:04.57046","status":"completed"},"tags":[]},"source":["dt2201<- rename(dt2201,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )\n"]},{"cell_type":"markdown","id":"a98234de","metadata":{"papermill":{"duration":0.019038,"end_time":"2022-06-20T08:15:04.60931","exception":false,"start_time":"2022-06-20T08:15:04.590272","status":"completed"},"tags":[]},"source":["dt2202<- rename(dt2202,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )"]},{"cell_type":"markdown","id":"dc5649af","metadata":{"papermill":{"duration":0.011619,"end_time":"2022-06-20T08:15:04.631355","exception":false,"start_time":"2022-06-20T08:15:04.619736","status":"completed"},"tags":[]},"source":["dt2203<- rename(dt2203,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )"]},{"cell_type":"markdown","id":"a3781621","metadata":{"papermill":{"duration":0.010087,"end_time":"2022-06-20T08:15:04.651577","exception":false,"start_time":"2022-06-20T08:15:04.64149","status":"completed"},"tags":[]},"source":["dt2204<- rename(dt2204,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )"]},{"cell_type":"markdown","id":"6d9d79b8","metadata":{"papermill":{"duration":0.01003,"end_time":"2022-06-20T08:15:04.671438","exception":false,"start_time":"2022-06-20T08:15:04.661408","status":"completed"},"tags":[]},"source":["dt2205<- rename(dt2205,  trip_id= ride_id\n","                   ,bikeid =rideable_type \n","                  , start_time  =started_at\n","                   ,end_time  =ended_at \n","                   , from_station_name =start_station_name \n","                   ,from_station_id =start_station_id \n","                   ,to_station_name =end_station_name \n","                   , to_station_id =end_station_id \n","                   ,usertype=member_casual )"]},{"cell_type":"markdown","id":"5db7bb06","metadata":{"papermill":{"duration":0.010636,"end_time":"2022-06-20T08:15:04.691823","exception":false,"start_time":"2022-06-20T08:15:04.681187","status":"completed"},"tags":[]},"source":["# Checking all the variable names are same"]},{"cell_type":"markdown","id":"62bea9eb","metadata":{"papermill":{"duration":0.010072,"end_time":"2022-06-20T08:15:04.711946","exception":false,"start_time":"2022-06-20T08:15:04.701874","status":"completed"},"tags":[]},"source":["colnames(dt2106)\n","colnames(dt2107)\n","colnames(dt2108)\n","colnames(dt2109)\n","colnames(dt2110)\n","colnames(dt2111)\n","colnames(dt2112)\n","colnames(dt2201)\n","colnames(dt2202)\n","colnames(dt2203)\n","colnames(dt2204)\n","colnames(dt2205)\n"]},{"cell_type":"markdown","id":"acadd8e3","metadata":{"papermill":{"duration":0.010587,"end_time":"2022-06-20T08:15:04.732329","exception":false,"start_time":"2022-06-20T08:15:04.721742","status":"completed"},"tags":[]},"source":["# Combining previous 12 months data"]},{"cell_type":"markdown","id":"fdfba654","metadata":{"papermill":{"duration":0.010581,"end_time":"2022-06-20T08:15:04.752706","exception":false,"start_time":"2022-06-20T08:15:04.742125","status":"completed"},"tags":[]},"source":["all_ride<-  rbind(dt2106,dt2107,dt2108,dt2109,dt2110,dt2111,dt2112,dt2201,dt2202,dt2203,dt2204,dt2205)\n","head(all_ride)"]},{"cell_type":"markdown","id":"1d1da221","metadata":{"papermill":{"duration":0.010025,"end_time":"2022-06-20T08:15:04.772404","exception":false,"start_time":"2022-06-20T08:15:04.762379","status":"completed"},"tags":[]},"source":["head(all_ride)"]},{"cell_type":"markdown","id":"21c006d7","metadata":{"papermill":{"duration":0.00998,"end_time":"2022-06-20T08:15:04.791948","exception":false,"start_time":"2022-06-20T08:15:04.781968","status":"completed"},"tags":[]},"source":["# Excluding unnecessary variables"]},{"cell_type":"markdown","id":"72e66ae3","metadata":{"papermill":{"duration":0.009914,"end_time":"2022-06-20T08:15:04.811496","exception":false,"start_time":"2022-06-20T08:15:04.801582","status":"completed"},"tags":[]},"source":["all_ride <- all_ride %>%  \n","  select(-c(start_lat,start_lng,end_lng,end_lat))\n"]},{"cell_type":"markdown","id":"3d476a57","metadata":{"papermill":{"duration":0.011256,"end_time":"2022-06-20T08:15:04.832413","exception":false,"start_time":"2022-06-20T08:15:04.821157","status":"completed"},"tags":[]},"source":["# Getting a overview of the data\n","nrow(all_ride)\n","head(all_ride)\n","str(all_ride)\n","colnames(all_ride)\n","dim(all_ride)\n","summary(all_ride)\n","glimpse(all_ride)\n"]},{"cell_type":"markdown","id":"1d5ddaf8","metadata":{"papermill":{"duration":0.010341,"end_time":"2022-06-20T08:15:04.853621","exception":false,"start_time":"2022-06-20T08:15:04.84328","status":"completed"},"tags":[]},"source":["table(all_ride$usertype)\n"]},{"cell_type":"markdown","id":"301d9e40","metadata":{"papermill":{"duration":0.0099,"end_time":"2022-06-20T08:15:04.873414","exception":false,"start_time":"2022-06-20T08:15:04.863514","status":"completed"},"tags":[]},"source":["# Recoding Date variable as Date formate\n"," all_ride <-  all_ride %>% \n","  mutate(date = as.Date(start_time))"]},{"cell_type":"markdown","id":"06c113a8","metadata":{"papermill":{"duration":0.010593,"end_time":"2022-06-20T08:15:04.893948","exception":false,"start_time":"2022-06-20T08:15:04.883355","status":"completed"},"tags":[]},"source":["all_ride$month <- format(as.Date(all_ride$date), \"%m\")\n","all_ride$day <- format(as.Date(all_ride$date), \"%d\")\n","all_ride$year <- format(as.Date(all_ride$date), \"%Y\")\n","all_ride$day_of_week <- format(as.Date(all_ride$date), \"%A\")\n"]},{"cell_type":"markdown","id":"5772eaea","metadata":{"papermill":{"duration":0.011107,"end_time":"2022-06-20T08:15:04.916323","exception":false,"start_time":"2022-06-20T08:15:04.905216","status":"completed"},"tags":[]},"source":["all_ride$ride_length <- difftime(all_ride$end_time,all_ride$start_time)"]},{"cell_type":"markdown","id":"08c4a546","metadata":{"papermill":{"duration":0.012529,"end_time":"2022-06-20T08:15:04.939075","exception":false,"start_time":"2022-06-20T08:15:04.926546","status":"completed"},"tags":[]},"source":["head(all_ride)\n","str(all_ride)"]},{"cell_type":"markdown","id":"f2a4a2eb","metadata":{"papermill":{"duration":0.011825,"end_time":"2022-06-20T08:15:04.961061","exception":false,"start_time":"2022-06-20T08:15:04.949236","status":"completed"},"tags":[]},"source":["class(all_ride$ride_length)\n","\n","all_ride$ride_length <- as.numeric(as.character(all_ride$ride_length))\n","is.numeric(all_ride$ride_length)\n"]},{"cell_type":"markdown","id":"6bbcad14","metadata":{"papermill":{"duration":0.010124,"end_time":"2022-06-20T08:15:04.981118","exception":false,"start_time":"2022-06-20T08:15:04.970994","status":"completed"},"tags":[]},"source":["head(all_ride)\n","glimpse(all_ride)"]},{"cell_type":"markdown","id":"1f7d5179","metadata":{"papermill":{"duration":0.011259,"end_time":"2022-06-20T08:15:05.00215","exception":false,"start_time":"2022-06-20T08:15:04.990891","status":"completed"},"tags":[]},"source":["# removing bad data\n","\n","all_ride_v2 <- all_ride[!(all_ride$from_station_name== \"HQ QR\" | all_ride$ride_length<0),]\n"]},{"cell_type":"markdown","id":"00d0a466","metadata":{"papermill":{"duration":0.010542,"end_time":"2022-06-20T08:15:05.022512","exception":false,"start_time":"2022-06-20T08:15:05.01197","status":"completed"},"tags":[]},"source":["colnames(all_ride_v2)"]},{"cell_type":"markdown","id":"1836d3f7","metadata":{"papermill":{"duration":0.010045,"end_time":"2022-06-20T08:15:05.042242","exception":false,"start_time":"2022-06-20T08:15:05.032197","status":"completed"},"tags":[]},"source":["write.csv(all_ride_v2,\"all_ride_v2.csv\")"]},{"cell_type":"markdown","id":"62375328","metadata":{"papermill":{"duration":0.009836,"end_time":"2022-06-20T08:15:05.061618","exception":false,"start_time":"2022-06-20T08:15:05.051782","status":"completed"},"tags":[]},"source":["all_ride_v3<- subset(all_ride,all_ride$from_station_name != \"HQ QR\" & ride_length >=0)"]},{"cell_type":"markdown","id":"babd406d","metadata":{"papermill":{"duration":0.009902,"end_time":"2022-06-20T08:15:05.081061","exception":false,"start_time":"2022-06-20T08:15:05.071159","status":"completed"},"tags":[]},"source":["nrow(all_ride_v2)\n","nrow(all_ride_v3)"]},{"cell_type":"markdown","id":"7ece0824","metadata":{"papermill":{"duration":0.010532,"end_time":"2022-06-20T08:15:05.10136","exception":false,"start_time":"2022-06-20T08:15:05.090828","status":"completed"},"tags":[]},"source":["#descriptive analysis\n"]},{"cell_type":"markdown","id":"66113b7c","metadata":{"papermill":{"duration":0.010058,"end_time":"2022-06-20T08:15:05.121174","exception":false,"start_time":"2022-06-20T08:15:05.111116","status":"completed"},"tags":[]},"source":["summary(all_ride_v2$ride_length)"]},{"cell_type":"markdown","id":"adc3ae3b","metadata":{"papermill":{"duration":0.011476,"end_time":"2022-06-20T08:15:05.144549","exception":false,"start_time":"2022-06-20T08:15:05.133073","status":"completed"},"tags":[]},"source":["\n","# Compare members and casual users\n","aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype, FUN = mean)\n","aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype, FUN = median)\n","aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype, FUN = max)\n","aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype, FUN = min)\n"]},{"cell_type":"markdown","id":"db1dbdef","metadata":{"papermill":{"duration":0.01021,"end_time":"2022-06-20T08:15:05.165439","exception":false,"start_time":"2022-06-20T08:15:05.155229","status":"completed"},"tags":[]},"source":["aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype + all_ride_v2$day_of_week, FUN = mean)"]},{"cell_type":"markdown","id":"9ca4d337","metadata":{"papermill":{"duration":0.01083,"end_time":"2022-06-20T08:15:05.186244","exception":false,"start_time":"2022-06-20T08:15:05.175414","status":"completed"},"tags":[]},"source":["all_ride_v2$day_of_week <- ordered(all_ride_v2$day_of_week, levels=c(\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"))\n"]},{"cell_type":"markdown","id":"54709137","metadata":{"papermill":{"duration":0.010191,"end_time":"2022-06-20T08:15:05.206624","exception":false,"start_time":"2022-06-20T08:15:05.196433","status":"completed"},"tags":[]},"source":["colnames(all_ride_v2)"]},{"cell_type":"markdown","id":"2a2916e9","metadata":{"papermill":{"duration":0.011622,"end_time":"2022-06-20T08:15:05.228208","exception":false,"start_time":"2022-06-20T08:15:05.216586","status":"completed"},"tags":[]},"source":["# Creating a csv file by reducing column to visualize at tableau"]},{"cell_type":"markdown","id":"ea35f322","metadata":{"papermill":{"duration":0.010388,"end_time":"2022-06-20T08:15:05.248699","exception":false,"start_time":"2022-06-20T08:15:05.238311","status":"completed"},"tags":[]},"source":["all_ride_v4 <- all_ride_v2 %>%  \n","  select(-c(trip_id,bikeid,from_station_id,to_station_id,date,end_lat))\n"]},{"cell_type":"markdown","id":"9710aa5e","metadata":{"papermill":{"duration":0.010045,"end_time":"2022-06-20T08:15:05.270387","exception":false,"start_time":"2022-06-20T08:15:05.260342","status":"completed"},"tags":[]},"source":["colnames(all_ride_v4)\n"]},{"cell_type":"markdown","id":"540371b7","metadata":{"papermill":{"duration":0.009874,"end_time":"2022-06-20T08:15:05.290117","exception":false,"start_time":"2022-06-20T08:15:05.280243","status":"completed"},"tags":[]},"source":["write.csv(all_ride_v4, \"all_ride_v4.csv\")"]},{"cell_type":"markdown","id":"37439d9e","metadata":{"papermill":{"duration":0.011367,"end_time":"2022-06-20T08:15:05.311623","exception":false,"start_time":"2022-06-20T08:15:05.300256","status":"completed"},"tags":[]},"source":["head(all_ride_v4)"]},{"cell_type":"markdown","id":"5f9d719d","metadata":{"papermill":{"duration":0.011002,"end_time":"2022-06-20T08:15:05.333229","exception":false,"start_time":"2022-06-20T08:15:05.322227","status":"completed"},"tags":[]},"source":["# Continueing exploratory analysis in R"]},{"cell_type":"markdown","id":"206ed0dc","metadata":{"papermill":{"duration":0.01009,"end_time":"2022-06-20T08:15:05.353276","exception":false,"start_time":"2022-06-20T08:15:05.343186","status":"completed"},"tags":[]},"source":["aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype + all_ride_v2$day_of_week, FUN = mean)"]},{"cell_type":"markdown","id":"d006d652","metadata":{"papermill":{"duration":0.010138,"end_time":"2022-06-20T08:15:05.373304","exception":false,"start_time":"2022-06-20T08:15:05.363166","status":"completed"},"tags":[]},"source":["# Analyze ridership data by type and weekday\n","all_ride_v2 %>% \n","  mutate(weekday = wday(start_time, label = TRUE)) %>%  \n","group_by(usertype, weekday) %>%  \n","  summarise(number_of_rides = n()\n","  ,average_duration = mean(ride_length)) %>% \n","  arrange(usertype, weekday)"]},{"cell_type":"markdown","id":"b037b500","metadata":{"papermill":{"duration":0.00998,"end_time":"2022-06-20T08:15:05.393067","exception":false,"start_time":"2022-06-20T08:15:05.383087","status":"completed"},"tags":[]},"source":["# Let's visualize the number of rides by rider type\n","all_ride_v2 %>% \n","  mutate(weekday = wday(start_time, label = TRUE)) %>% \n","  group_by(usertype, weekday) %>% \n","  summarise(number_of_rides = n()\n","            ,average_duration = mean(ride_length)) %>% \n","  arrange(usertype, weekday)  %>% \n","  ggplot(aes(x = weekday, y = number_of_rides, fill = usertype)) +\n","  geom_col(position = \"dodge\")\n"]},{"cell_type":"markdown","id":"4376f9fb","metadata":{"papermill":{"duration":0.01011,"end_time":"2022-06-20T08:15:05.414553","exception":false,"start_time":"2022-06-20T08:15:05.404443","status":"completed"},"tags":[]},"source":["# Let's create a visualization for average duration\n","all_ride_v2 %>% \n","  mutate(weekday = wday(start_time, label = TRUE)) %>% \n","  group_by(usertype, weekday) %>% \n","  summarise(number_of_rides = n()\n","            ,average_duration = mean(ride_length)) %>% \n","  arrange(usertype, weekday)  %>% \n","  ggplot(aes(x = weekday, y = average_duration, fill = usertype)) +\n","  geom_col(position = \"dodge\")\n","\n"]},{"cell_type":"markdown","id":"f683cf0f","metadata":{"papermill":{"duration":0.010813,"end_time":"2022-06-20T08:15:05.436298","exception":false,"start_time":"2022-06-20T08:15:05.425485","status":"completed"},"tags":[]},"source":["avg_ride_length <- aggregate(all_ride_v2$ride_length ~ all_ride_v2$usertype + all_ride_v2$day_of_week, FUN = mean)"]},{"cell_type":"markdown","id":"4bfdbf39","metadata":{"papermill":{"duration":0.010336,"end_time":"2022-06-20T08:15:05.456529","exception":false,"start_time":"2022-06-20T08:15:05.446193","status":"completed"},"tags":[]},"source":["write.csv(avg_ride_length,\"avg_ride_length.csv\")\n"]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":5.540759,"end_time":"2022-06-20T08:15:05.587286","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2022-06-20T08:15:00.046527","version":"2.3.4"}},"nbformat":4,"nbformat_minor":5}